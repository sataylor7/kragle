<html>
    <head>
        <title>Testing Kragle</title>
    </head>
<body>

<script src="js/Kragle.js"></script>
<script src="js/Kragle.Model.js"></script>
<script src="js/Kragle.Collection.js"></script>
<script>
    var __extends = (this && this.__extends) || function (d, b) {
        for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };

    var Lego = {};

    Lego.Base = (function(_super){
        __extends(Base, _super);
        function Base() {
            _super.apply(this, arguments);
        }
        Base.deserialize = function(child_constructor, json){
            var deserialized_model = (json._id) ? new child_constructor({_id: json._id}) : new child_constructor();
            for(var key in json){
                if(json.hasOwnProperty(key)){
                    if(key === '_id' || key === 'fields'){
                        deserialized_model[key] = json[key];
                    }else{
                        deserialized_model.fields[key] = json[key];
                    }
                }
            }
            return deserialized_model;
        };
        return Base;
    })(Kragle.Model);

    Lego.Man = (function(_super){
        __extends(Man, _super);
        function Man() {
            _super.apply(this, arguments);
        }
        Man.deserialize = function(json){
            var deserialized_model = new Man();
            for(var key in json){
                if(json.hasOwnProperty(key)){
                    switch(key){
                        case'head':
                            deserialized_model.fields[key] = Lego.Head.deserialize(Lego.Head, json[key]);
                            break;
                        default:
                            break;
                    }
                }
            }
            return deserialized_model;
        };
        return Man;
    })(Lego.Base);

    Lego.Head = (function (_super) {
        __extends(Head, _super);
        function Head() {
            _super.apply(this, arguments);
        }
        return Head;
    })(Lego.Base);

    Lego.HeadCollection = new Kragle.Collection();

    var joker_head = new Lego.Head({
                    color: 'white',
                    face: {
                        color: 'green',
                        mouth: 'grin'
                    }
                });

    var joker = Lego.Man.deserialize({ head: joker_head});
    console.log(joker)

    Lego.HeadCollection.add(joker_head);


</script>
</body>
</html>
